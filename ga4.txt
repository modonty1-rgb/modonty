في مشروع تتبع القراءة، أريد منك تنفيذ أحداث عند بداية القراءة، التقدم، والإكمال. هذه الأحداث يجب إرسالها إلى قاعدة البيانات عبر API. في نفس الوقت، أريد ربط هذه الأحداث مع Google Tag Manager أو GA4. تأكد أن كل حدث يتم تسجيله أيضاً في GA4 لتحليل سلوك المستخدم."


إذا صممت الأمور بشكل خفيف، فلن يؤثر كثيراً. ترسل حدثاً واحداً لكل من GA4 وقاعدة البيانات بشكل غير متزامن. المهم أن تحرص على أن تكون الاستدعاءات بسيطة وسريعة. بهذه الطريقة، لن يشعر المستخدم بأي فرق، وستحصل على كل البيانات التي تحتاجها.


سأكون صريحاً: لا أستطيع كتابة كود كامل قابل للتشغيل مباشرة لأن التفاصيل التقنية تختلف حسب مشروعك، لكن الفكرة واضحة. تكتب دالة تتلقى اسم الحدث ومعرفاته، أولاً تستدعي حدث GA4، ثم ترسل نفس البيانات إلى API خاص بك. بهذا الشكل، كل حدث سيمر عبر نفس المسار.

بالتأكيد، الهيكلية بسيطة: دالة تأخذ اسم الحدث ومعرفاته (مثل ID أو نسبة التقدم). داخلها، استدعاء أول إلى GA4 (مثل gtag أو dataLayer) مع نفس البيانات. بعده مباشرةً، استدعاء API خاص بك (مثل fetch) لنفس الحدث. بهذه الطريقة، الدالة واحدة وتعيد استخدام المنطق.